Challenges Identified:
Search engine information leading to actualized revenue was in a separate hit record than the actualized revenue.
Based on the domain of the referrer, the format of the keywords channges. I checked ask.com, duckduckgo, baidu, and yandex to make sure their formats were included.


Assumptions:
As the input file is hit data, it was assumed that it was in cronological order by timestamp.
The client was interested in revenue generated by outside search engines, so any searches within the esshopzilla domain were ignored.
Input files were left in S3 bucket for archiving purposes.

To track the search engine that led to actualized revenue, a dictionary was used based on ip address. There are two options that I identified to connect search engines to actualized revenue. The first option is to iterate through the file locating actualized revenue and storing the associated ip address in a dictionary, and then iterate through a second time to store search engine information only on these ip addresses. The second option is to store search engine information for every ip address in a dictionary, and reference that when actualized revenue is detected. Option one sacrifices speed for lower RAM utilization, option two is the inverse.

I opted for option 2 to get faster results, however it is less scalable.

It may be worth noting to the client that ip address isn't always an accurate representation of a unique visitor ( VPNs etc )